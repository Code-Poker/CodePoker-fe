import{fromJSON as ee,crossSerializeStream as te,getCrossReferenceHeader as re}from"seroval";import{CustomEventPlugin as E,DOMExceptionPlugin as L,EventPlugin as M,FormDataPlugin as I,HeadersPlugin as O,ReadableStreamPlugin as j,RequestPlugin as z,ResponsePlugin as U,URLSearchParamsPlugin as N,URLPlugin as W}from"seroval-plugins/web";import{lazy as se,createComponent as ne,createSignal as w,createResource as B,createEffect as ae,Suspense as V,Show as D,children as oe,sharedConfig as X}from"solid-js";import{ssrElement as $,escape as o,mergeProps as T,ssr as c,ssrHydrationKey as u,createComponent as i,For as P,ssrAttribute as R,renderToStringAsync as ie}from"solid-js/web";import{provideRequestEvent as G}from"solid-js/web/storage";import{H3Event as _,setResponseStatus as ce,setHeader as le,getRequestURL as ue,getRequestIP as de,getResponseStatus as fe,getResponseStatusText as pe,getCookie as he,setCookie as ge,getResponseHeaders as me,getResponseHeader as ye,setResponseHeader as ve,appendResponseHeader as be,getRequestWebStream as Re,removeResponseHeader as we,eventHandler as $e}from"h3";import{getContext as xe}from"unctx";import{AsyncLocalStorage as Se}from"node:async_hooks";import{createRouter as _e}from"radix3";function Ce(e){let r;const t=J(e),s={duplex:"half",method:e.method,headers:e.headers};return e.node.req.body instanceof ArrayBuffer?new Request(t,{...s,body:e.node.req.body}):new Request(t,{...s,get body(){return r||(r=Me(e),r)}})}function ke(e){return e.web??={request:Ce(e),url:J(e)},e.web.request}function Te(){return je()}const v=Symbol("$HTTPEvent");function Pe(e){return typeof e=="object"&&(e instanceof _||e?.[v]instanceof _||e?.__is_event__===!0)}function d(e){return function(...r){let t=r[0];if(Pe(t))r[0]=t instanceof _||t.__is_event__?t:t[v];else{if(!globalThis.app.config.server.experimental?.asyncContext)throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(t=Te(),!t)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");r.unshift(t)}return e(...r)}}const J=d(ue),qe=d(de),C=d(ce),H=d(fe),He=d(pe),b=d(me),F=d(ye),Fe=d(ve),Ae=d(be),Ee=d(he),Le=d(ge),K=d(le),Me=d(Re),Ie=d(we);function Oe(){return xe("nitro-app",{asyncContext:!!globalThis.app.config.server.experimental?.asyncContext,AsyncLocalStorage:Se})}function je(){return Oe().use().event}const x="Invariant Violation",{setPrototypeOf:ze=function(e,r){return e.__proto__=r,e}}=Object;class q extends Error{framesToPop=1;name=x;constructor(r=x){super(typeof r=="number"?`${x}: ${r} (see https://github.com/apollographql/invariant-packages)`:r),ze(this,q.prototype)}}function Ue(e,r){if(!e)throw new q(r)}const S=Symbol("fetchEvent");function Ne(e){return{request:ke(e),response:De(e),clientAddress:qe(e),locals:{},nativeEvent:e,[v]:e}}function We(e){return{...e,[v]:e[v]}}function Be(e){if(!e[S]){const r=Ne(e);e[S]=r}return e[S]}function A(e,r){for(const[t,s]of r.entries())K(e,t,s)}class Ve{constructor(r){this.event=r}get(r){const t=F(this.event,r);return Array.isArray(t)?t.join(", "):t}has(r){return this.get(r)!==void 0}set(r,t){return Fe(this.event,r,t)}delete(r){return Ie(this.event,r)}append(r,t){Ae(this.event,r,t)}getSetCookie(){const r=F(this.event,"Set-Cookie");return Array.isArray(r)?r:[r]}forEach(r){return Object.entries(b(this.event)).forEach(([t,s])=>r(Array.isArray(s)?s.join(", "):s,t,this))}entries(){return Object.entries(b(this.event)).map(([r,t])=>[r,Array.isArray(t)?t.join(", "):t])[Symbol.iterator]()}keys(){return Object.keys(b(this.event))[Symbol.iterator]()}values(){return Object.values(b(this.event)).map(r=>Array.isArray(r)?r.join(", "):r)[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function De(e){return{get status(){return H(e)},set status(r){C(e,r)},get statusText(){return He(e)},set statusText(r){C(e,H(),r)},headers:new Ve(e)}}function Xe(e){e.forEach(r=>{if(!r.attrs.href)return;let t=document.head.querySelector(`link[href="${r.attrs.href}"]`);t||(t=document.createElement("link"),t.setAttribute("rel","preload"),t.setAttribute("as","style"),t.setAttribute("href",r.attrs.href),document.head.appendChild(t))})}var Ge=" ";const Je={style:e=>$("style",e.attrs,()=>o(e.children),!0),link:e=>$("link",e.attrs,void 0,!0),script:e=>e.attrs.src?$("script",T(()=>e.attrs,{get id(){return e.key}}),()=>c(Ge),!0):null};function Ke(e){let{tag:r,attrs:{key:t,...s}={key:void 0},children:a}=e;return Je[r]({attrs:s,key:t,children:a})}function Qe(e,r,t,s="default"){return se(async()=>{{const p=(await e.import())[s],f=(await r.inputs?.[e.src].assets()).filter(g=>g.tag==="style"||g.attrs.rel==="stylesheet");return typeof window<"u"&&Xe(f),{default:g=>[...f.map(h=>Ke(h)),ne(p,g)]}}})}const Q=[],Ye=Ze(Q.filter(e=>e.$component));function Ze(e){function r(t,s,a,p){const l=Object.values(t).find(f=>a.startsWith(f.id+"/"));return l?(r(l.children||(l.children=[]),s,a.slice(l.id.length)),t):(t.push({...s,id:a,path:a.replace(/\/\([^)/]+\)/g,"")}),t)}return e.sort((t,s)=>t.path.length-s.path.length).reduce((t,s)=>r(t,s,s.path,s.path),[])}function et(e){return e.$GET||e.$POST||e.$PUT||e.$PATCH||e.$DELETE}_e({routes:Q.reduce((e,r)=>{if(!et(r))return e;let t=r.path.replace(/\(.*\)\/?/g,"").replace(/\*([^/]*)/g,(s,a)=>`**:${a}`);if(/:[^/]*\?/g.test(t))throw new Error(`Optional parameters are not supported in API routes: ${t}`);if(e[t])throw new Error(`Duplicate API routes for "${t}" found at "${e[t].route.path}" and "${r.path}"`);return e[t]={route:r},e},{})});function tt(){function e(t){return{...t,...t.$$route?t.$$route.require().route:void 0,info:{...t.$$route?t.$$route.require().route.info:{},filesystem:!0},component:Qe(t.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:t.children?t.children.map(e):void 0}}return Ye.map(e)}function rt(e){const r=Ee(e,"flash");if(!r)return;let t=JSON.parse(r);if(!t||!t.result)return[];const s=[...t.input.slice(0,-1),new Map(t.input[t.input.length-1])];return Le(e,"flash","",{maxAge:0}),{url:t.url,result:t.error?new Error(t.result):t.result,input:s}}async function st(e){const r=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,e.response.headers.set("Content-Type","text/html"),Object.assign(e,{manifest:await r.json(),assets:[...await r.inputs[r.handler].assets()],router:{submission:rt(e)},routes:tt(),$islands:new Set})}const k="http://172.30.1.38:3000/",nt=async()=>(await fetch(k+"poker")).json(),at=async e=>(console.log("fetching",e),e=="recent"?(await(await fetch(k+"poker/"+e)).json()).result:(await(await fetch(k+"poker/"+e+"/calc")).json()).result);var ot=["<div",' class="loader">Loading...</div>'];function Y(){return c(ot,u())}var it=["<div",' class="grid md:grid-cols-3 xl:grid-cols-4 gap-6 w-full">',"</div>"],ct=["<a","><div","><!--$-->","<!--/--> : <!--$-->","<!--/--><!--$-->","<!--/--></div></a>"];function lt(e){return console.log(e.problems),c(it,u(),o(i(P,{get each(){return e.problems},children:r=>i(ut,r)})))}function ut(e){const[r,t]=w("bg-[#000]");e.level<7?t("bg-[#c67739]"):e.level<21?t("bg-[#4e6a86]"):e.level<60?t("bg-[#ffb028]"):e.level<159?t("bg-[#51fdbd]"):e.level<412?t("bg-[#2bbfff]"):e.level<801&&t("bg-[#ff3071]");const s="https://boj.kr/"+e.id;return c(ct,u()+R("href",o(s,!0),!1),R("class",o(r(),!0),!1),o(e.id),o(e.title),o(e.level))}var dt=["<div",' class="result-view grid md:grid-cols-3 xl:grid-cols-4 gap-6 w-full p-6">',"</div>"],ft=["<div",' class="background"></div>'],pt=["<div",' class="modal">',"</div>"],ht=["<button",">","</button>"],gt=["<img",' width="30" height="30" src="https://static.solved.ac/logo.svg">'],mt=["<div",' class="rounded-lg border bg-card text-card-foreground shadow-sm cursor-pointer" data-v0-t="card"><div class="p-6 flex flex-col items-center"><img',' width="150" height="150" alt="User 1" class="rounded-full border-2 border-gray-100" style="aspect-ratio:150 / 150;object-fit:cover;"><div class="flex"><h2 class="text-lg font-semibold pr-2">',"</h2><!--$-->",'<!--/--></div><p class="text-sm text-gray-500 dark:text-gray-400">tier placeholder</p></div><div class="items-center px-6 pb-6 flex justify-between"><div class="flex flex-col text-sm"><span class="font-semibold">Points</span><span class="text-sm text-gray-500 dark:text-gray-400">','</span></div><div class="flex flex-col text-sm"><span class="font-semibold">Goal</span><span class="text-sm text-gray-500 dark:text-gray-400">',"</span></div></div></div>"];function yt(e){const[r,t]=w("recent"),[s]=B(r,at);return ae(()=>t(e.id)),c(dt,u(),o(i(V,{get fallback(){return i(Y,{})},get children(){return i(P,{get each(){return Object.keys(s()===void 0?{}:s())},children:a=>i(bt,T(()=>s()[a]))})}})))}function vt(e){const[r,t]=w(!1),s=oe(()=>e.children);return i(D,{get when(){return r()},get fallback(){return c(ht,u(),o(s()))},get children(){return[c(ft,u()),c(pt,u(),o(i(lt,e)))]}})}function bt(e){return i(vt,T(e,{get children(){return c(mt,u(),R("src",o(e.profileImage,!0),!1),o(e.handle),o(i(D,{get when(){return e.goal<=e.point},get children(){return c(gt,u())}})),o(e.point),o(e.goal))}}))}var Rt=["<ul",' class="poker-list">',"</ul>"],wt=["<div",' class="side-nav"><div><!--$-->',"<!--/--><!--$-->","<!--/--></div></div>"],$t=["<li",' class="','">',"</li>"],xt=["<div",' class="logo"><!--$-->','<!--/--><div class="title">Code Poker</div></div>'],St=["<div",' class="icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve"><g id="_x31_0_x2C__Ace_Of_Spades_x2C__Poker_x2C__Casino_x2C__Gambler_x2C__Gambling_x2C__Cards_x2C__Shapes_x2C__Bet"><g><path style="fill:#FFFFFF;" d="M421,41v430c0,16.57-13.43,30-30,30H121c-16.57,0-30-13.43-30-30V41c0-16.57,13.43-30,30-30h270    C407.57,11,421,24.43,421,41z"></path><path style="fill:#FFFFFF;" d="M375.84,402.59c7.31,8.75,6.85,21.8-1.37,30.02c-4.35,4.35-10.06,6.53-15.76,6.53    c-5.1,0-10.19-1.74-14.33-5.22c-8.76,7.37-21.85,6.93-30.09-1.31c-4.35-4.35-6.53-10.05-6.53-15.76c0-5.07,1.72-10.14,5.17-14.26    c0.42-0.52,0.88-1.02,1.36-1.5L344.38,371l30.09,30.09C374.95,401.57,375.41,402.07,375.84,402.59z"></path><path style="fill:#FFFFFF;" d="M199.08,82.59c7.31,8.75,6.85,21.8-1.37,30.02c-4.35,4.35-10.06,6.53-15.76,6.53    c-5.1,0-10.2-1.74-14.33-5.22c-8.76,7.37-21.85,6.93-30.09-1.31c-4.35-4.35-6.53-10.05-6.53-15.76c0-5.07,1.72-10.14,5.16-14.26    c0.43-0.52,0.89-1.02,1.37-1.5L167.62,51l30.09,30.09C198.19,81.57,198.65,82.07,199.08,82.59z"></path><path style="fill:#000;" d="M333.62,230.19c18.04,21.61,16.92,53.8-3.37,74.09c-10.74,10.74-24.82,16.11-38.89,16.11    c-12.58,0-25.16-4.29-35.36-12.87c-21.61,18.18-53.91,17.1-74.25-3.24c-10.74-10.74-16.11-24.81-16.11-38.89    c0-12.52,4.25-25.03,12.74-35.2c1.05-1.27,2.18-2.5,3.37-3.69L256,152.25l74.25,74.25C331.44,227.69,332.57,228.92,333.62,230.19z    "></path><g><path style="fill:#000;" d="M391,1H121C98.944,1,81,18.944,81,41v430c0,22.056,17.944,40,40,40h270c22.056,0,40-17.944,40-40     V41C431,18.944,413.056,1,391,1z M411,471c0,11.028-8.972,20-20,20H121c-11.028,0-20-8.972-20-20V41c0-11.028,8.972-20,20-20h270     c11.028,0,20,8.972,20,20V471z"></path><path style="fill:#000;" d="M306.001,359.75c0-5.523-4.478-10-10-10h-30v-24.514c23.538,9.96,51.868,5.567,71.321-13.885     c23.848-23.848,25.414-61.889,4.007-87.532c-3.339-4.039-1.389-1.644-78.257-78.64c-3.906-3.905-10.236-3.905-14.143,0     l-74.248,74.249c-25.214,25.197-25.561,66.365-0.002,91.923c19.195,19.196,47.568,23.965,71.321,13.903v24.496h-30.002     c-5.522,0-10,4.477-10,10s4.478,10,10,10c25.424,0,54.577,0,80.002,0C301.523,369.75,306.001,365.273,306.001,359.75z      M188.822,297.208c-16.826-16.825-17.331-43.163-2.733-60.647c2.191-2.649-0.735,0.566,69.912-70.169l67.181,67.18     c17.694,17.703,17.69,45.944-0.002,63.636c-16.223,16.224-42.263,17.926-60.784,2.626c-3.635-3.033-9.056-3.132-12.832,0.033     C231.875,314.748,205.194,313.581,188.822,297.208z"></path><path style="fill:#000;" d="M157.619,141c0,5.523,4.478,10,10,10s10-4.477,10-10v-12.164     c28.999,3.932,48.061-29.987,29.168-52.616c-1.631-1.977-0.303-0.432-32.097-32.292c-3.906-3.905-10.236-3.905-14.143,0     c-31.606,31.673-30.447,30.298-32.062,32.249c-10.512,12.591-10.044,31.491,1.971,43.505c7.303,7.302,17.466,10.373,27.162,9.095     V141z M141,96.851c0-3.157,1.227-6.313,3.6-8.689l23.02-23.02l23.02,23.02c7.644,7.63,2.281,20.979-8.689,20.979     c-2.803,0-5.553-0.931-7.93-2.896c-3.74-3.121-9.158-3.055-12.837,0.029C153.335,112.876,141,107.358,141,96.851z"></path><path style="fill:#000;" d="M351.453,363.929c-3.89-3.889-10.225-3.916-14.143,0c-31.767,31.833-30.477,30.327-32.061,32.248     c-10.515,12.592-10.043,31.494,1.97,43.506c7.303,7.303,17.466,10.372,27.162,9.095V461c0,5.523,4.478,10,10,10s10-4.477,10-10     v-12.806c10.714,0.551,22.586-3.937,27.161-8.511c12.691-12.692,12.703-32.951,0-45.663L351.453,363.929z M367.4,425.54     c-4.382,4.383-11.488,4.945-16.619,0.704c-3.653-3.049-9.063-3.115-12.798-0.002c-5.105,4.238-12.3,3.619-16.623-0.702     c-4.548-4.549-4.783-11.726-0.724-16.588c0.577-0.698-0.461,0.418,23.744-23.81c24.298,24.322,23.133,23.072,23.779,23.852     C372.188,413.819,371.854,421.086,367.4,425.54z"></path></g></g></g><g id="Layer_1"></g></svg></div>'];function _t(){const[e,r]=w("recent"),[t]=B(nt);return[c(wt,u(),o(i(Ct,{})),o(i(V,{get fallback(){return i(Y,{})},get children(){return c(Rt,u(),o(i(P,{get each(){return t()},children:s=>(e()==="recent"&&r(s.id),c($t,u()+R("key",o(s.id,!0),!1),e()===s.id?"selected":"",o(s.name)))})))}}))),i(yt,{get id(){return e()}})]}function Ct(){return c(xt,u(),o(i(kt,{})))}function kt(){return c(St,u())}function Tt(e){const t=e.length.toString(16),s="00000000".substring(0,8-t.length)+t;return new TextEncoder().encode(`;0x${s};${e}`)}function Pt(e,r){return new ReadableStream({start(t){te(r,{scopeId:e,plugins:[E,L,M,I,O,j,z,U,N,W],onSerialize(s,a){t.enqueue(Tt(a?`(${re(e)},${s})`:s))},onDone(){t.close()},onError(s){t.error(s)}})}})}async function qt(e){const r=Be(e),t=r.request,s=t.headers.get("X-Server-Id"),a=t.headers.get("X-Server-Instance"),p=t.headers.has("X-Single-Flight"),l=new URL(t.url);let f,y;if(s)Ue(typeof s=="string","Invalid server function"),[f,y]=s.split("#");else if(f=l.searchParams.get("id"),y=l.searchParams.get("name"),!f||!y)throw new Error("Invalid request");const g=(await globalThis.MANIFEST["server-fns"].chunks[f].import())[y];let h=[];if(!a||e.method==="GET"){const n=l.searchParams.get("args");n&&JSON.parse(n).forEach(m=>h.push(m))}if(e.method==="POST"){const n=t.headers.get("content-type");if(n.startsWith("multipart/form-data")||n.startsWith("application/x-www-form-urlencoded"))h.push(await new Request(t,{...t,body:e.node.req.body}).formData());else{const m=new Request(t,{...t,body:e.node.req.body});h=ee(await m.json(),{plugins:[E,L,M,I,O,j,z,U,N,W]})}}try{let n=await G(r,async()=>(X.context={event:r},g(...h)));if(p&&a&&(n=await Ht(r,n)),n instanceof Response&&a&&(n.headers&&A(e,n.headers),n.customBody?n=await n.customBody():n.body==null&&(n=null)),!a){const m=n instanceof Error,Z=new URL(t.headers.get("referer"));return new Response(null,{status:302,headers:{Location:Z.toString(),...n?{"Set-Cookie":`flash=${JSON.stringify({url:l.pathname+encodeURIComponent(l.search),result:m?n.message:n,error:m,input:[...h.slice(0,-1),[...h[h.length-1].entries()]]})}; Secure; HttpOnly;`}:{}}})}return!n||typeof n=="string"?n||null:(K(e,"content-type","text/javascript"),Pt(a,n))}catch(n){return n instanceof Response&&(n.status===302&&!a&&C(e,302),n.headers&&A(e,n.headers),n.customBody?n=await n.customBody():n.body==null&&(n=null)),n}}async function Ht(e,r){let t,s=new URL(e.request.headers.get("referer")).toString();r instanceof Response&&(r.headers.has("X-Revalidate")&&(t=r.headers.get("X-Revalidate").split(",")),r.headers.has("Location")&&(s=new URL(r.headers.get("Location"),new URL(e.request.url).origin+"").toString()));const a=We(e);return a.request=new Request(s),await G(a,async()=>{await st(a),X.context={event:a},a.router.dataOnly=t||!0,a.router.previousUrl=e.request.headers.get("referer"),ie(_t);const p=a.router.data;if(p){let l=!1;for(const f in p)p[f]===void 0?delete p[f]:l=!0;return l&&(r instanceof Response||(p._$value=r,r=new Response(null,{status:200})),r.customBody=()=>p,r.headers.set("X-Single-Flight","true")),r}})}const Ut=$e(qt);export{Ut as default};
